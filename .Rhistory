tidyr::spread(key = "varname", value = "value")
}) %>%
# > Compute correlation matrix for the selected set of variables (all days)
map(~ {
.x %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
# Remove useless variables
dplyr::select(-stno) %>%
# Compute correlation coefficient
cor(.)
})
z_data_wei_log %>% dplyr::select(-stno, )
test <- cor(z_data_wei_log)
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n")
dev.off()
test <- cor(z_data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value"))
cor(z_data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value") %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value")
)
(z_data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value")
test <- cor(data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
# Remove useless variables
dplyr::select(-stno))
data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature))
data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value")
data_wei_log %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
# Remove useless variables
dplyr::select(-stno)
data_wei_log %>%
tidyr::gather(key = "var", value = "value", -stno) %>%
left_join(tab.name, by = "var") %>%
dplyr::select(-var) %>%
tidyr::spread(key = "varname", value = "value") %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
# Remove useless variables
dplyr::select(-stno)
test <- cor(data_wei_log %>%
tidyr::gather(key = "var", value = "value", -stno) %>%
left_join(tab.name, by = "var") %>%
dplyr::select(-var) %>%
tidyr::spread(key = "varname", value = "value") %>%
# Rename variables to remove the end of the labels
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
# Remove useless variables
dplyr::select(-stno))
names(data_wei_log)
test <- cor(data_named$wei %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n")
dev.off()
# > Selected set of metrics (without number of bouts of different lengths)
#   Non-standardized metrics
load("00_DATA\\00_data_PCA_k_means.rda")
data$wei
names(data$wei)
data
# > Join data and tab.name to have a clean version of variables
data_named <- data %>%
map(., ~ {
.x %>%
tidyr::gather(key = "var", value = "value", -stno) %>%
left_join(tab.name, by = "var") %>%
dplyr::select(-var) %>%
tidyr::spread(key = "varname", value = "value")
})
# > Check variables names
data_named %>%
map_dfr(., ~{ data.frame(var = names(.x))}, .id = "dataset") %>%
filter(var != "stno",
!var %in% unique(tab.name$varname))
test <- cor(data_named$wei %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n")
dev.off()
test <- cor(data_named$wei %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 2,
tl.cex = 2,
tl.col = "black",
cl.pos = "n")
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1.5,
tl.cex = 1.5,
tl.col = "black",
cl.pos = "n")
dev.off()
# > Join data and tab.name to have a clean version of variables
data_named <- data_full %>%
map(., ~ {
.x %>%
tidyr::gather(key = "var", value = "value", -stno) %>%
left_join(tab.name, by = "var") %>%
dplyr::select(-var) %>%
tidyr::spread(key = "varname", value = "value")
})
# > Check variables names
data_named %>%
map_dfr(., ~{ data.frame(var = names(.x))}, .id = "dataset") %>%
filter(var != "stno",
!var %in% unique(tab.name$varname))
test <- cor(data_named$wei %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test.png",
height = 900,
width = 900)
corrplot(test2,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1.5,
tl.cex = 1.5,
tl.col = "black",
cl.pos = "n")
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1.5,
tl.cex = 1.5,
tl.col = "black",
cl.pos = "n")
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n")
dev.off()
test <- cor(data_named$WD_WE %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
data_named$WD_WE %>%
gather(key = "feature", value = "value", -stno)
data_named$WD_WE %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature))
data_named$WD_WE %>%
gather(key = "feature", value = "value", -stno) %>%
#mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno)
test <- cor(data_named$WD_WE %>%
gather(key = "feature", value = "value", -stno) %>%
#mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n")
test <- cor(data_named$WD %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n")
dev.off()
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features")
test <- cor(data_named$WD %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features")
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 900,
width = 900)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features",
mar=c(0,0,1,0) )
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 800,
width = 800)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features",
mar=c(0,0,1,0))
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 850,
width = 850)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features",
mar=c(0,0,1,0))
dev.off()
test <- cor(data_named$WE %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 850,
width = 850)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features",
mar=c(0,0,1,0))
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 850,
width = 850)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Weekend days - full set of features",
mar=c(0,0,1,0))
dev.off()
data_named <- data %>%
map(., ~ {
.x %>%
tidyr::gather(key = "var", value = "value", -stno) %>%
left_join(tab.name, by = "var") %>%
dplyr::select(-var) %>%
tidyr::spread(key = "varname", value = "value")
})
test <- cor(data_named$WE %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 850,
width = 850)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1,
tl.cex = 1,
tl.col = "black",
cl.pos = "n",
title = "Weekend days - full set of features",
mar=c(0,0,1,0))
dev.off()
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 800,
width = 800)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1.5,
tl.cex = 1.5,
tl.col = "black",
cl.pos = "n",
title = "Weekend days - full set of features",
mar=c(0,0,1,0))
dev.off()
test <- cor(data_named$WD %>%
gather(key = "feature", value = "value", -stno) %>%
mutate(feature = sub(" - .*", "", feature)) %>%
spread(key = "feature", value = "value") %>%
dplyr::select(-stno))
png(filename = "01_EXPLORATORY_ANALYSES\\plots\\test2.png",
height = 800,
width = 800)
corrplot(test,
method="color",
col=col(200),
diag=FALSE,
type="lower",
#order="hclust",
addCoef.col = "black",
number.cex = 1.5,
tl.cex = 1.5,
tl.col = "black",
cl.pos = "n",
title = "Week days - full set of features",
mar=c(0,0,1,0))
dev.off()
library(tidyverse)
library(haven)
# packages for PCA and clustering
library(cluster)
library(FactoMineR)
library(factoextra)
# -----------------------------
# Data
# > Selected set of metrics (without number of bouts of different lengths)
#   Non-standardized metrics
load("00_DATA\\00_data_PCA_k_means.rda")
data_wei        <- data$wei
# with transformed variables (log(x+1))
data_wei_log    <- data$wei_log
#   Standardized metrics
load("00_DATA\\00_z_data_PCA_k_means.rda")
z_data_wei        <- z_data$wei
# with transformed variables (log(x+1))
z_data_wei_log    <- z_data$wei_log
